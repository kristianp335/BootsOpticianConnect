[#assign
        showLabel = input.showLabel && input.label?has_content && (layoutMode == "edit" || input.readOnly)
        inputLabel = htmlUtil.escape(input.label)
        readonlyLabel = inputLabel + " (" + languageUtil.get(locale, "read-only") + ")"
]

[#if input.readOnly]
        [#assign inputLabel = readonlyLabel]
[/#if]

<div class="upload-field-input [#if !input.showLabel || !input.label?has_content]upload-field-input--hidden-label[/#if]" [#if layoutMode != "edit"]style="display: none;"[/#if]>
        <div class="form-group [#if input.errorMessage?has_content]has-error[/#if] mb-0" data-localizable="${input.localizable?string('true', 'false')}" data-readonly-label="${readonlyLabel}" id="${fragmentEntryLinkNamespace}-upload-field-input">

                [#if layoutMode == "edit"]
                        <div role="presentation">
                                <label class="[#if !showLabel]sr-only[/#if]">
                                        ${htmlUtil.escape(input.label)} [#if input.readOnly](${languageUtil.get(locale, "read-only")})[#elseif input.required][@clay["icon"] className="reference-mark" symbol="asterisk" /][/#if]
                                </label>

                                <div class="file-upload-preview bg-light border rounded p-3">
                                        <div class="d-flex align-items-center justify-content-center">
                                                <div class="text-center">
                                                        [@clay["icon"] className="text-muted" symbol="upload" /]
                                                        <div class="mt-2 text-muted small">
                                                                File upload field (${htmlUtil.escape(input.name)})
                                                        </div>
                                                        <div class="mt-1 text-secondary small">
                                                                Hidden in view mode - only visible to content editors
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                        </div>
                [#else]
                        <div class="d-flex">
                                <div class="flex-grow-1">
                                        <input 
                                                type="file" 
                                                class="form-control-file" 
                                                name="${fragmentEntryLinkNamespace}-${input.name}" 
                                                id="${fragmentEntryLinkNamespace}-${input.name}"
                                                [#if input.required]required[/#if]
                                                [#if input.readOnly]readonly disabled[/#if]
                                        />
                                </div>

                                [#if !input.localizable && input.attributes.unlocalizedFieldsMessage??]
                                        <div aria-label="${input.attributes.unlocalizedFieldsMessage}" class="d-none lfr-portal-tooltip mt-3 pt-3" data-title="${input.attributes.unlocalizedFieldsMessage}" id="${fragmentEntryLinkNamespace}-unlocalized-info" role="tooltip" tabindex="0">
                                                [@clay["icon"] className="ml-2 mt-0 text-secondary" symbol="question-circle-full" /]
                                        </div>
                                [/#if]
                        </div>
                [/#if]

                [#if input.errorMessage?has_content]
                        <p class="font-weight-semi-bold mt-1 text-danger">
                                <svg class="lexicon-icon lexicon-icon-info-circle" focusable="false" role="presentation">
                                        <use xlink:href="${siteSpritemap}#info-circle" />
                                </svg>

                                <span>
                                        ${input.errorMessage}
                                </span>
                        </p>
                [/#if]

                [#if input.showHelpText && input.helpText?has_content]
                        <p class="mb-0 mt-1 text-secondary" id="${fragmentEntryLinkNamespace}-upload-field-input-help-text">
                                ${htmlUtil.escape(input.helpText)}
                        </p>
                [/#if]
        </div>
</div>